@page
@model Immense.RemoteControl.Server.Areas.RemoteControl.Pages.ViewerModel

@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=0.9, user-scalable=no" />
    <title>@(Model.PageTitle)</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="description" content="@(Model.PageDescription)" />
    <link href="/_content/Immense.RemoteControl.Server/manifest.json" rel="manifest" />
    <link rel="icon" href="@(Model.FaviconUrl)" />
    <link href="/_content/Immense.RemoteControl.Server/css/remote-control.css" rel="stylesheet" asp-append-version="true" />

    @if (!string.IsNullOrWhiteSpace(Model.ThemeUrl))
{
    <link href="@(Model.ThemeUrl)" rel="stylesheet" asp-append-version="true" />
}

    <link href="/_content/Immense.RemoteControl.Server/lib/fontawesome/css/all.min.css" rel="stylesheet" />

    <environment include="Development">
        <script src="/_content/Immense.RemoteControl.Server/lib/microsoft-signalr/signalr.js"></script>
        <script src="/_content/Immense.RemoteControl.Server/lib/microsoft/signalr-protocol-msgpack/dist/browser/signalr-protocol-msgpack.js"></script>
        <script src="/_content/Immense.RemoteControl.Server/lib/msgpack/dist.es5+umd/msgpack.js"></script>
    </environment>
    <environment exclude="Development">
        <script src="/_content/Immense.RemoteControl.Server/lib/microsoft-signalr/signalr.min.js"></script>
        <script src="/_content/Immense.RemoteControl.Server/lib/microsoft/signalr-protocol-msgpack/dist/browser/signalr-protocol-msgpack.min.js"></script>
        <script src="/_content/Immense.RemoteControl.Server/lib/msgpack/dist.es5+umd/msgpack.min.js"></script>
    </environment>
</head>
<body>
    <div id="backgroundLayers" class="background-layers">
        <div class="background-layer-1"></div>
        <div class="background-layer-2"></div>
        <div class="background-layer-3"></div>

        @if (!string.IsNullOrWhiteSpace(Model.LogoUrl))
        {
            <div class="logo-frame">
                <img src="@(Model.LogoUrl)" />
            </div>
        }
    </div>

    <button id="keyboardButton" hidden="hidden" title="Invoke the mobile touch keyboard.">
        <i class="fas fa-keyboard align-middle"></i>
    </button>

    <div style="display: none">

        <div class="menu-options-header">
            Actions
        </div>

        <div>

            <button id="inviteButton" title="Copy a link that lets another person view the remote screen.">
                Invite Others  <i class="fas fa-user-plus"></i>
            </button>

            <button id="audioButton" title="Windows only.  Stream the remote audio to the browser.">
                Audio <i class="fas fa-volume-up"></i>
            </button>

            <button id="fileTransferButton" title="Transfer files to the remote computer.">
                File Transfer  <i class="fas fa-file-upload"></i>
            </button>
        </div>


        <div class="menu-options-header">
            View
        </div>

        <div>


        </div>


        <div class="menu-options-header">
            Recording
        </div>

        <div>
            <button id="recordSessionButton" title="Record session as a WEBM video in the browser.">
                Start <i class="fas fa-record-vinyl"></i>
            </button>

            <button id="downloadRecordingButton" title="Download the recorded session as a WEBM file.">
                Download <i class="fas fa-download"></i>
            </button>
        </div>

        <div class="menu-options-header">
            Windows Session
        </div>
        <div>
            <select id="windowsSessionSelect"
                    title="Switch to a different Windows session."
                   
                    style="height: 30px; width: 90%; margin: 5px 0;"></select>
        </div>

        <div class="menu-options-header">
            Metrics
        </div>
        <div class="metrics-body">
            <div>
                Mbps:
            </div>
            <div id="mbpsDiv">
            </div>
            <div>
                FPS:
            </div>
            <div id="fpsDiv">
            </div>
            <div>
                Latency:
            </div>
            <div id="latencyDiv">
            </div>
            <div>
                GPU:
            </div>
            <div id="gpuAcceleratedDiv">
            </div>
        </div>
    </div>

    <div id="screenSelectBar" class="d-none">

    </div>

    <div id="clipboardTransferBar" class="d-none">
        <div>
            Shared Clipboard
        </div>
        <div>
            <button id="typeClipboardButton">Type Clipboard</button>
        </div>
    </div>

    <div id="fileTransferBar" class="d-none">
        <div>
            File Transfer
        </div>
        <div>
            <button id="fileUploadButton">Upload File</button>
            <button id="fileDownloadButton">Download File</button>
        </div>
    </div>

    <div class="connection-box-wrapper">
        <div class="text-center">
            <h2 id="connectHeader" class="connect-header" style="display: none">
                Connect to a Client
            </h2>
        </div>
        <div id="connectBox" class="center-connection-box" style="display: none">
            <form id="connectForm">
                <div class="form-block">
                    <label class="input-label">Your Name (shown to client)</label>
                    <input id="nameInput" type="text" required value="@Model.UserDisplayName" />
                </div>
                <div class="form-block">
                    <label class="input-label">Session ID</label>
                    <input id="sessionIDInput" required type="text" pattern="[0-9 ]+" />
                </div>
                <div>
                    <button id="connectButton" disabled class="bg-primary">
                        Connect
                    </button>
                </div>

            </form>
        </div>

        <div id="statusMessage" class="status-message">
        </div>

    </div>

    <div id="workAreaGrid" style="display: none;">
        <div>
            <div id="menuFrame">
                <div class="text-left">
                    @if (!string.IsNullOrWhiteSpace(Model.LogoUrl))
                    {
                        <img class="menu-logo" src="@(Model.LogoUrl)" />
                    }
                </div>
                 <div>
                    <button 
                        id="changeScreenButton" 
                        title="Switch monitors on remote multi-monitor setups.">
                        <i class="fas fa-desktop"></i>
                        Monitors
                    </button>

                    <button 
                        id="viewOnlyButton" 
                        title="If toggled, prevents sending commnads and input to the remote computer.">
                        <i class="fas fa-eye"></i>
                        View Only
                    </button>

                    <button 
                        id="clipboardTransferButton"  
                        title="Type the current clipboard text on the remote computer.">
                         <i class="fas fa-clipboard"></i>
                         Clipboard
                    </button>

                    <button
                        id="blockInputButton" 
                        title="Prevent remote user from using keyboard and mouse.">
                        <i class="fas fa-mouse"></i>
                        Block Remote Input
                    </button>

                    <button 
                        id="ctrlAltDelButton" 
                        title="Simulate the Ctrl+Alt+Del command on the remote computer."
                        class="d-none">
                        <i class="fas fa-sign-in-alt"></i>
                        Ctrl+Alt+Del
                    </button>
                </div>

                <div class="menu-right-column">
                    <button 
                        id="disconnectButton"
                        title="Disconnect from the current session.">
                        x
                    </button>

                    <button id="moreMenuButton">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>

                    <button id="fullScreenButton" title="Enter fullscreen mode.">
                        <i class="fas fa-window-maximize"></i>
                    </button>

                    <button 
                        id="fitToScreenButton" 
                        class="toggled" 
                        title="If toggled, will resize image to fit in the window.">
                        <i class="fas fa-expand"></i>
                    </button>
                </div>
            </div>

            <div class="text-center">
                <button id="menuButton">
                    <i class="fas fa-chevron-down"></i>
                </button>
            </div>
        </div>
        <div>
            <div id="screenViewerWrapper">
                <canvas id="screenViewer" class="fit"></canvas>
                <input id="fileTransferInput" hidden="hidden" type="file" multiple />
                <textarea id="touchKeyboardTextArea" value=" #"> #</textarea>
            </div>
        </div>

    </div>

    <div id="toastsWrapper">

    </div>


    <div id="fileTransferDiv" hidden="hidden">
        <span id="fileTransferNameSpan" class="mr-1 font-weight-bold" style="vertical-align: middle;"></span>
        <progress id="fileTransferProgress" style="vertical-align: middle; width: 100%"></progress>
    </div>

    <footer>
        <div class="copyright-text">
            &copy; @(DateTime.Now.Year) - Immense Networks
        </div>
    </footer>

    <script src="/_content/Immense.RemoteControl.Server/src/App.js" type="module"></script>
    <script>
        window.addEventListener("load", () => {
            ViewerApp.Init();
        })
    </script>
</body>
</html>
